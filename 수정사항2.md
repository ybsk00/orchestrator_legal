# AntiGravity 수정 작업 지시서 (v1.0)
목표: “AI 캐릭터 1개 + 루프 영상 2개(Idle/Talk)”를 에셋으로 만들고, 좌측 패널에 Agent1/2/3 3개 캐릭터 카드가 항상 보이도록 구성한다.  
발화자(activeSpeaker)가 바뀔 때마다 해당 카드만 `talk` 영상 + 발화 하이라이트(빛/글로우/확대)를 적용하고, 나머지는 `idle` 영상으로 유지한다.  
에셋은 3명이 **공유**한다(파일명만 1세트).

---

## 1) 생성해야 하는 에셋(필수)
### 1.1 이미지 1개(참조/폴백)
- 파일명: `avatar.png`
- 용도: 영상 생성 시 레퍼런스(가능하면) + 영상 로딩 실패/지연 시 폴백

### 1.2 루프 영상 2개(공유)
- 파일명:
  - `idle.webm` (또는 `idle.mp4`)
  - `talk.webm` (또는 `talk.mp4`)
- 길이: 3~4초 권장
- 요구: “완전 루프(seamless loop)”로 제작

---

## 2) 이미지 생성 프롬프트(1개)
**Prompt (Image)**
> A stylized 3D animated character (clean Pixar-like but NOT cartoonish, semi-realistic), Korean young adult, friendly neutral expression, upper-body portrait, facing forward, centered composition, dark studio background with subtle gradient, soft key light + rim light, high-quality skin shading, detailed hair, wearing a simple solid-color hoodie (no logos, no text), no accessories, no glasses, no hat.  
> Camera: medium close-up (chest-up), 50mm lens look, shallow depth of field, sharp focus on face.  
> Style: high-end 3D render, smooth geometry, realistic materials, clean edges.  
> Output: single character only, no extra objects, no hands visible.  
> Negative: text, watermark, logo, extra people, busy background, exaggerated facial features, heavy makeup.

**생성 설정 권장**
- 가능하면 seed 고정 또는 “reference image” 기능을 사용하여 이후 영상 생성에 동일성 유지
- 배경/조명/구도는 영상과 동일하게 유지(어두운 스튜디오 그라데이션)

---

## 3) 영상 제작용 액션 프롬프트(2개)
> 공통 조건: “Use the provided character reference.”는 `avatar.png`를 레퍼런스로 넣을 수 있을 때만 적용. 레퍼런스 기능이 없으면 “same character, same outfit, same lighting, same background”를 강하게 유지.

### 3.1 Idle 루프 (대기 상태)
**Prompt (Video Action: IDLE LOOP)**
> Use the provided character reference. Create a seamless 3–4 second loop. The character is standing still, facing forward, calm and attentive. Very subtle breathing motion in shoulders and chest, occasional natural blink (once), tiny head micro-movements (almost imperceptible). Keep facial expression neutral-friendly. No speaking. No hand gestures.  
> Background stays the same dark studio gradient. Lighting stays constant. Camera locked, no zoom, no shake.  
> Output should loop perfectly.

### 3.2 Talk 루프 (발화 상태)
**Prompt (Video Action: TALK LOOP)**
> Use the provided character reference. Create a seamless 3–4 second loop. The character is speaking softly to the viewer: subtle mouth movement (light articulation), small natural head nods (1–2), gentle eyebrow micro-expression, occasional blink (once). Keep it professional and calm, not exaggerated.  
> No large gestures, no hands visible, no body turning.  
> Background stays the same dark studio gradient. Lighting stays constant. Camera locked, no zoom, no shake.  
> Output should loop perfectly.

---

## 4) 파일 배치 규칙(Next.js 기준)
아래 경로에 배치(정적 서빙용):
- `public/avatars/avatar.png`
- `public/avatars/idle.webm`
- `public/avatars/talk.webm`

프론트에서는 다음 URL로 접근:
- `/avatars/avatar.png`
- `/avatars/idle.webm`
- `/avatars/talk.webm`

---

## 5) 프론트 연출 규칙(좌측 캐릭터 패널)
### 5.1 좌측 패널 구성
- Agent 카드 3개(Agent1 / Agent2 / Agent3)를 세로 또는 가로로 고정 배치
- 각 카드 구성:
  - 상단: 에이전트 이름 라벨(예: “Agent 1 Planner”)
  - 중앙: 비디오 영역(video tag)
  - 하단: 상태 라벨(예: Idle / Speaking)

### 5.2 상태 전환 로직
- 서버 SSE 이벤트 `speaker_change` payload:
  - `{ activeSpeaker: "agent1" | "agent2" | "agent3" | "none" }`
- 프론트 동작:
  - activeSpeaker == 해당 에이전트 → 비디오 소스 `talk.webm` + speaking 효과 ON
  - 그 외 → 비디오 소스 `idle.webm` + speaking 효과 OFF

### 5.3 speaking 효과(필수: 최소 2개 적용)
- 글로우/라이트 효과(테두리 + box-shadow)
- 미세 확대(scale 1.02~1.05)
- 카드 배경 밝기 상승(또는 라이트 그라데이션 강화)
- (선택) 발화자만 살짝 위로 떠오르는 느낌(translateY -2px)

### 5.4 “3명처럼 보이게” 최소 구분(권장)
에셋은 동일해도 되므로, UI 테마로 구분:
- Agent1: 블루 계열 글로우
- Agent2: 퍼플 계열 글로우
- Agent3: 그린 계열 글로우
또는 라벨/배지 색상만 다르게 적용

---

## 6) 실패/폴백 처리(필수)
- 비디오 로드 실패 시:
  - `avatar.png`로 대체 표시
  - “Video load failed” 같은 작은 상태 텍스트 출력
- 초기 로딩 동안:
  - 스켈레톤/로딩 인디케이터 또는 `avatar.png` 표시

---

## 7) 완료 기준(Definition of Done)
- [ ] `avatar.png`, `idle.webm`, `talk.webm` 3개 파일이 생성되어 `public/avatars/`에 배치된다.
- [ ] 좌측 패널에 Agent 3개 카드가 항상 보인다.
- [ ] `speaker_change` 이벤트에 따라 발화자 카드만 `talk` 영상으로 전환되고, 나머지는 `idle` 영상 유지한다.
- [ ] 발화자 카드에는 글로우/확대 등 speaking 효과가 적용된다.
- [ ] `activeSpeaker="none"`이면 전원 `idle` 상태로 복귀한다.
- [ ] 비디오 로드 실패 시 `avatar.png`로 폴백된다.

---

## 8) 작업 순서(권장)
1) 이미지 `avatar.png` 생성(캐릭터 확정)
2) `idle` 루프 영상 생성(레퍼런스 적용)
3) `talk` 루프 영상 생성(레퍼런스 적용)
4) 파일 배치(`public/avatars/`)
5) 프론트 좌측 패널 구현 + `speaker_change` 연동
6) speaking 효과(CSS) 적용 + 폴백 처리

---
